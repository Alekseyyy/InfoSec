## Modified exploit for CVE-2019-9053

This is a modified exploit for [CMS Made Simple (n.d.)](https://www.cmsmadesimple.org/) that takes advantage of a SQL injection vulnerability in a version of it that is less than 2.2.10. The exploit was originally written by [Scanu (2019)](https://www.exploit-db.com/exploits/46635), but it failed when I tried to run it in a version of Python 3. I made minor modifications to Scanu's original script to fix some of the errors that came up. 

### Details

I originally fixed it to solve a jeopardy-ctf style TryHackMe room by ["MrSeth6797" (2019)](https://tryhackme.com/room/easyctf). I started by adding parenthesis to the ``print`` statements in the exploit and then modifying the ``crack_password()`` function like this:

```python
def crack_password():
    global password
    global output
    global wordlist
    global salt
    
    with open(wordlist, "r", encoding="ISO-8859-1") as currentWordlist:
        for line in currentWordlist.readlines():
            line = line.replace("\n", "")
            beautify_print_try(line)
            if hashlib.md5(str(salt).encode("utf-8") + line.encode("utf-8")).hexdigest() == password:
                output += "\n[+] Password cracked: " + line
                break
```

It can be downloaded here: [exploit.zip](./exploit.zip), and I recommend that any users who want to see the (very small) changes that I made use Linux's ``diff`` tool to compare the differences between the Python script in ``exploit.zip`` and [Scanu (2019)](https://www.exploit-db.com/exploits/46635)'s implementation. Do note that I __have not__ fixed any problems regarding exceptions caused by connection timeouts (and other potential issues with the script).

### References

* CMS Made Simple (n.d.). Open Source Content Management System. Retrieved on Mar. 
    4, 2023 from: https://www.cmsmadesimple.org/
* "MrSeth6797" (2019). Simple CTF: Beginner level ctf. TryHackMe. Retrieved on Mar.
    4, 2023 from: https://tryhackme.com/room/easyctf
* Scanu, D. (2019). CMS Made Simple < 2.2.10 â€” SQL Injection. Exploit Database. 
    Retrieved on Mar. 4, 2023 from: https://www.exploit-db.com/exploits/46635
